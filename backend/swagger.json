{
  "openapi": "3.0.3",
  "info": {
    "title": "ThreatCheck API",
    "description": "A RESTful API for scanning files using ClamAV antivirus engine with PostgreSQL logging. This API provides endpoints to scan single or multiple files, calculate file hashes (MD5, SHA1, SHA256), and maintain a complete audit log of all scan activities.",
    "version": "1.0.0",
    "contact": {
      "name": "ThreatCheck API Support",
      "email": "support@threatcheck.com"
    },
    "license": {
      "name": "ISC",
      "url": "https://opensource.org/licenses/ISC"
    }
  },
  "servers": [
    {
      "url": "http://localhost:3000",
      "description": "Development server"
    },
    {
      "url": "https://api.threatcheck.com",
      "description": "Production server"
    }
  ],
  "tags": [
    {
      "name": "Health",
      "description": "API health monitoring endpoints"
    },
    {
      "name": "Scan",
      "description": "File scanning operations"
    },
    {
      "name": "History",
      "description": "Scan history and logging"
    },
    {
      "name": "Signatures",
      "description": "ClamAV signature management"
    }
  ],
  "paths": {
    "/health": {
      "get": {
        "tags": ["Health"],
        "summary": "Health check endpoint",
        "description": "Returns the health status of the API and ClamAV service",
        "operationId": "getHealth",
        "responses": {
          "200": {
            "description": "Service is healthy",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                },
                "example": {
                  "status": "healthy",
                  "timestamp": "2025-07-02T10:30:00.000Z",
                  "clamav": "ClamAV 1.0.0/26995/Tue Jul  2 10:30:00 2025"
                }
              }
            }
          },
          "500": {
            "description": "Service is unhealthy",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthErrorResponse"
                },
                "example": {
                  "status": "unhealthy",
                  "error": "ClamAV service unavailable",
                  "timestamp": "2025-07-02T10:30:00.000Z"
                }
              }
            }
          }
        }
      }
    },
    "/api/scan/file": {
      "post": {
        "tags": ["Scan"],
        "summary": "Scan a single file",
        "description": "Upload and scan a single file for threats. The file will be scanned using ClamAV and its MD5, SHA1, and SHA256 hashes will be calculated. Results are logged to the database.",
        "operationId": "scanSingleFile",
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary",
                    "description": "The file to scan (max 100MB)"
                  }
                },
                "required": ["file"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "File scanned successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SingleScanResponse"
                },
                "example": {
                  "success": true,
                  "scanId": 123,
                  "filename": "document.pdf",
                  "fileSize": 1024,
                  "hashes": {
                    "md5": "5d41402abc4b2a76b9719d911017c592",
                    "sha1": "aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d",
                    "sha256": "2c26b46b68ffc68ff99b453c1d30413413422d706483bfa0f98a5e886266e7ae"
                  },
                  "scanResult": {
                    "isClean": true,
                    "isInfected": false,
                    "threats": [],
                    "scanTime": "2025-07-02T10:30:00.000Z"
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request - no file uploaded or file too large",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "examples": {
                  "noFile": {
                    "summary": "No file uploaded",
                    "value": {
                      "success": false,
                      "error": "No file uploaded"
                    }
                  },
                  "fileTooLarge": {
                    "summary": "File too large",
                    "value": {
                      "success": false,
                      "error": "File too large",
                      "message": "File size exceeds 100MB limit"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error during scan",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "success": false,
                  "error": "Internal server error during file scan",
                  "message": "ClamAV service unavailable"
                }
              }
            }
          }
        }
      }
    },
    "/api/scan/files": {
      "post": {
        "tags": ["Scan"],
        "summary": "Scan multiple files",
        "description": "Upload and scan multiple files for threats (up to 10 files). Each file will be scanned using ClamAV and their hashes will be calculated. All results are logged to the database.",
        "operationId": "scanMultipleFiles",
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "files": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "format": "binary"
                    },
                    "description": "Array of files to scan (max 10 files, 100MB each)",
                    "maxItems": 10
                  }
                },
                "required": ["files"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Files scanned successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MultipleScanResponse"
                },
                "example": {
                  "success": true,
                  "totalFiles": 3,
                  "processedFiles": 3,
                  "results": [
                    {
                      "scanId": 124,
                      "filename": "file1.txt",
                      "fileSize": 256,
                      "hashes": {
                        "md5": "5d41402abc4b2a76b9719d911017c592",
                        "sha1": "aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d",
                        "sha256": "2c26b46b68ffc68ff99b453c1d30413413422d706483bfa0f98a5e886266e7ae"
                      },
                      "scanResult": {
                        "isClean": true,
                        "isInfected": false,
                        "threats": [],
                        "scanTime": "2025-07-02T10:30:00.000Z"
                      }
                    },
                    {
                      "scanId": 125,
                      "filename": "file2.txt",
                      "fileSize": 512,
                      "hashes": {
                        "md5": "098f6bcd4621d373cade4e832627b4f6",
                        "sha1": "a94a8fe5ccb19ba61c4c0873d391e987982fbbd3",
                        "sha256": "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08"
                      },
                      "scanResult": {
                        "isClean": false,
                        "isInfected": true,
                        "threats": ["Win.Test.EICAR_HDB-1"],
                        "scanTime": "2025-07-02T10:30:01.000Z"
                      }
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "description": "Bad request - no files uploaded",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "success": false,
                  "error": "No files uploaded"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error during scan",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MultipleScanErrorResponse"
                },
                "example": {
                  "success": false,
                  "error": "Internal server error during files scan",
                  "message": "ClamAV service unavailable",
                  "partialResults": [
                    {
                      "scanId": 124,
                      "filename": "file1.txt",
                      "fileSize": 256,
                      "hashes": {
                        "md5": "5d41402abc4b2a76b9719d911017c592",
                        "sha1": "aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d",
                        "sha256": "2c26b46b68ffc68ff99b453c1d30413413422d706483bfa0f98a5e886266e7ae"
                      },
                      "scanResult": {
                        "isClean": true,
                        "isInfected": false,
                        "threats": [],
                        "scanTime": "2025-07-02T10:30:00.000Z"
                      }
                    }
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/scan/history": {
      "get": {
        "tags": ["History"],
        "summary": "Get scan history",
        "description": "Retrieve the history of all file scans from the database with pagination support",
        "operationId": "getScanHistory",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "description": "Number of records to return",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 50,
              "minimum": 1,
              "maximum": 1000
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of records to skip",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 0,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Scan history retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ScanHistoryResponse"
                },
                "example": {
                  "success": true,
                  "count": 2,
                  "limit": 50,
                  "offset": 0,
                  "data": [
                    {
                      "id": 123,
                      "filename": "document.pdf",
                      "file_size": 1024,
                      "md5_hash": "5d41402abc4b2a76b9719d911017c592",
                      "sha1_hash": "aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d",
                      "sha256_hash": "2c26b46b68ffc68ff99b453c1d30413413422d706483bfa0f98a5e886266e7ae",
                      "scan_result": "CLEAN",
                      "threats_found": [],
                      "scan_time": "2025-07-02T10:30:00.000Z",
                      "client_ip": "192.168.1.100",
                      "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"
                    },
                    {
                      "id": 124,
                      "filename": "malicious.exe",
                      "file_size": 2048,
                      "md5_hash": "44d88612fea8a8f36de82e1278abb02f",
                      "sha1_hash": "3395856ce81f2b7382dee72602f798b642f14140",
                      "sha256_hash": "275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f",
                      "scan_result": "INFECTED",
                      "threats_found": ["Win.Test.EICAR_HDB-1"],
                      "scan_time": "2025-07-02T10:29:00.000Z",
                      "client_ip": "192.168.1.101",
                      "user_agent": "curl/7.68.0"
                    }
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Error retrieving scan history",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "success": false,
                  "error": "Failed to fetch scan history",
                  "message": "Database connection error"
                }
              }
            }
          }
        }
      }
    },
    "/api/signatures/info": {
      "get": {
        "tags": ["Signatures"],
        "summary": "Get ClamAV signature information",
        "description": "Retrieve current ClamAV signature database information including version, signature counts, and update history",
        "operationId": "getSignatureInfo",
        "responses": {
          "200": {
            "description": "Signature information retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SignatureInfoResponse"
                },
                "example": {
                  "success": true,
                  "timestamp": "2025-07-03T10:30:00.000Z",
                  "current": {
                    "version": "ClamAV 1.0.0/26000/Mon Jul  1 10:30:00 2024",
                    "databases": [
                      {
                        "name": "main.cvd",
                        "signatures": 6647427,
                        "lastUpdate": "Mon Jul  1 10:30:00 2024"
                      },
                      {
                        "name": "daily.cvd",
                        "signatures": 2038936,
                        "lastUpdate": "Mon Jul  1 10:30:00 2024"
                      }
                    ],
                    "lastUpdate": "Mon Jul  1 10:30:00 2024",
                    "totalSignatures": 8686363
                  },
                  "updateHistory": []
                }
              }
            }
          },
          "500": {
            "description": "Error retrieving signature information",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "success": false,
                  "error": "Failed to fetch signature information",
                  "message": "ClamAV service unavailable"
                }
              }
            }
          }
        }
      }
    },
    "/api/signatures/update": {
      "post": {
        "tags": ["Signatures"],
        "summary": "Update ClamAV signatures",
        "description": "Trigger an update of ClamAV signature databases and log the update status",
        "operationId": "updateSignatures",
        "responses": {
          "200": {
            "description": "Signature update completed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SignatureUpdateResponse"
                },
                "example": {
                  "success": true,
                  "timestamp": "2025-07-03T10:30:00.000Z",
                  "updateResult": {
                    "updated": true,
                    "databases": ["main.cvd", "daily.cvd", "bytecode.cvd"],
                    "message": "Signature update completed successfully"
                  },
                  "before": {
                    "totalSignatures": 8686363
                  },
                  "after": {
                    "totalSignatures": 8686500
                  },
                  "message": "Signature update completed successfully"
                }
              }
            }
          },
          "500": {
            "description": "Error updating signatures",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "success": false,
                  "error": "Failed to update signatures",
                  "message": "ClamAV update service unavailable"
                }
              }
            }
          }
        }
      }
    },
    "/api/signatures/history": {
      "get": {
        "tags": ["Signatures"],
        "summary": "Get signature update history",
        "description": "Retrieve the history of ClamAV signature database updates with pagination support",
        "operationId": "getSignatureHistory",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "description": "Number of records to return",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 50,
              "minimum": 1,
              "maximum": 1000
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "Number of records to skip",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 0,
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Signature update history retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SignatureHistoryResponse"
                },
                "example": {
                  "success": true,
                  "count": 2,
                  "limit": 50,
                  "offset": 0,
                  "data": [
                    {
                      "id": 1,
                      "database_name": "main.cvd",
                      "version": "ClamAV 1.0.0/26000/Mon Jul  1 10:30:00 2024",
                      "signatures_count": 6647427,
                      "last_updated": "2025-07-03T10:30:00.000Z",
                      "update_status": "SUCCESS",
                      "update_details": "Signature update completed successfully",
                      "file_size": null
                    }
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Error retrieving signature update history",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                },
                "example": {
                  "success": false,
                  "error": "Failed to fetch signature update history",
                  "message": "Database connection error"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "HealthResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "enum": ["healthy"],
            "description": "Health status of the service"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp of the health check"
          },
          "clamav": {
            "type": "string",
            "description": "ClamAV version information"
          }
        },
        "required": ["status", "timestamp", "clamav"]
      },
      "HealthErrorResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "enum": ["unhealthy"],
            "description": "Health status of the service"
          },
          "error": {
            "type": "string",
            "description": "Error description"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp of the health check"
          }
        },
        "required": ["status", "error", "timestamp"]
      },
      "FileHashes": {
        "type": "object",
        "properties": {
          "md5": {
            "type": "string",
            "pattern": "^[a-f0-9]{32}$",
            "description": "MD5 hash of the file"
          },
          "sha1": {
            "type": "string",
            "pattern": "^[a-f0-9]{40}$",
            "description": "SHA1 hash of the file"
          },
          "sha256": {
            "type": "string",
            "pattern": "^[a-f0-9]{64}$",
            "description": "SHA256 hash of the file"
          }
        },
        "required": ["md5", "sha1", "sha256"]
      },
      "ScanResult": {
        "type": "object",
        "properties": {
          "isClean": {
            "type": "boolean",
            "description": "True if the file is clean (not infected)"
          },
          "isInfected": {
            "type": "boolean",
            "description": "True if the file is infected with malware"
          },
          "threats": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "List of detected threats/viruses"
          },
          "scanTime": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp when the scan was completed"
          }
        },
        "required": ["isClean", "isInfected", "threats", "scanTime"]
      },
      "SingleScanResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "enum": [true],
            "description": "Indicates successful operation"
          },
          "scanId": {
            "type": "integer",
            "description": "Unique identifier for this scan record"
          },
          "filename": {
            "type": "string",
            "description": "Original filename of the uploaded file"
          },
          "fileSize": {
            "type": "integer",
            "description": "Size of the file in bytes"
          },
          "hashes": {
            "$ref": "#/components/schemas/FileHashes"
          },
          "scanResult": {
            "$ref": "#/components/schemas/ScanResult"
          }
        },
        "required": ["success", "scanId", "filename", "fileSize", "hashes", "scanResult"]
      },
      "FileScanResult": {
        "type": "object",
        "properties": {
          "scanId": {
            "type": "integer",
            "description": "Unique identifier for this scan record"
          },
          "filename": {
            "type": "string",
            "description": "Original filename of the uploaded file"
          },
          "fileSize": {
            "type": "integer",
            "description": "Size of the file in bytes"
          },
          "hashes": {
            "$ref": "#/components/schemas/FileHashes"
          },
          "scanResult": {
            "$ref": "#/components/schemas/ScanResult"
          },
          "error": {
            "type": "string",
            "description": "Error message if file processing failed"
          },
          "message": {
            "type": "string",
            "description": "Detailed error message"
          }
        },
        "required": ["filename"]
      },
      "MultipleScanResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "enum": [true],
            "description": "Indicates successful operation"
          },
          "totalFiles": {
            "type": "integer",
            "description": "Total number of files uploaded"
          },
          "processedFiles": {
            "type": "integer",
            "description": "Number of files successfully processed"
          },
          "results": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/FileScanResult"
            },
            "description": "Array of scan results for each file"
          }
        },
        "required": ["success", "totalFiles", "processedFiles", "results"]
      },
      "MultipleScanErrorResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "enum": [false],
            "description": "Indicates failed operation"
          },
          "error": {
            "type": "string",
            "description": "Error description"
          },
          "message": {
            "type": "string",
            "description": "Detailed error message"
          },
          "partialResults": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/FileScanResult"
            },
            "description": "Partial results if some files were processed before error"
          }
        },
        "required": ["success", "error", "message"]
      },
      "ScanLogEntry": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "Unique identifier for the scan log entry"
          },
          "filename": {
            "type": "string",
            "description": "Original filename of the scanned file"
          },
          "file_size": {
            "type": "integer",
            "description": "Size of the file in bytes"
          },
          "md5_hash": {
            "type": "string",
            "pattern": "^[a-f0-9]{32}$",
            "description": "MD5 hash of the file"
          },
          "sha1_hash": {
            "type": "string",
            "pattern": "^[a-f0-9]{40}$",
            "description": "SHA1 hash of the file"
          },
          "sha256_hash": {
            "type": "string",
            "pattern": "^[a-f0-9]{64}$",
            "description": "SHA256 hash of the file"
          },
          "scan_result": {
            "type": "string",
            "enum": ["CLEAN", "INFECTED"],
            "description": "Result of the virus scan"
          },
          "threats_found": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Array of detected threats/viruses (empty array if clean)"
          },
          "scan_time": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp when the scan was performed"
          },
          "client_ip": {
            "type": "string",
            "description": "IP address of the client that uploaded the file"
          },
          "user_agent": {
            "type": "string",
            "description": "User agent string of the client"
          }
        },
        "required": ["id", "filename", "file_size", "md5_hash", "sha1_hash", "sha256_hash", "scan_result", "scan_time", "client_ip", "user_agent"]
      },
      "ScanHistoryResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "enum": [true],
            "description": "Indicates successful operation"
          },
          "count": {
            "type": "integer",
            "description": "Number of records returned"
          },
          "limit": {
            "type": "integer",
            "description": "Maximum number of records requested"
          },
          "offset": {
            "type": "integer",
            "description": "Number of records skipped"
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ScanLogEntry"
            },
            "description": "Array of scan log entries"
          }
        },
        "required": ["success", "count", "limit", "offset", "data"]
      },
      "ErrorResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "enum": [false],
            "description": "Indicates failed operation"
          },
          "error": {
            "type": "string",
            "description": "Error description"
          },
          "message": {
            "type": "string",
            "description": "Detailed error message"
          }
        },
        "required": ["success", "error"]
      },
      "SignatureInfoResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "enum": [true],
            "description": "Indicates successful operation"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp of the request"
          },
          "current": {
            "type": "object",
            "properties": {
              "version": {
                "type": "string",
                "description": "Current ClamAV version and signature database version"
              },
              "databases": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "name": {
                      "type": "string",
                      "description": "Name of the signature database file"
                    },
                    "signatures": {
                      "type": "integer",
                      "description": "Number of signatures in the database"
                    },
                    "lastUpdate": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Last update time of the database"
                    }
                  },
                  "required": ["name", "signatures", "lastUpdate"]
                },
                "description": "List of ClamAV signature databases and their details"
              },
              "lastUpdate": {
                "type": "string",
                "format": "date-time",
                "description": "Last update time of the signature databases"
              },
              "totalSignatures": {
                "type": "integer",
                "description": "Total number of signatures across all databases"
              }
            },
            "required": ["version", "databases", "lastUpdate", "totalSignatures"]
          },
          "updateHistory": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "integer",
                  "description": "Unique identifier for the update record"
                },
                "database_name": {
                  "type": "string",
                  "description": "Name of the updated database"
                },
                "version": {
                  "type": "string",
                  "description": "ClamAV version and signature database version at the time of update"
                },
                "signatures_count": {
                  "type": "integer",
                  "description": "Number of signatures in the database after update"
                },
                "last_updated": {
                  "type": "string",
                  "format": "date-time",
                  "description": "Timestamp of the update"
                },
                "update_status": {
                  "type": "string",
                  "enum": ["SUCCESS", "FAILURE"],
                  "description": "Status of the update operation"
                },
                "update_details": {
                  "type": "string",
                  "description": "Detailed information about the update"
                },
                "file_size": {
                  "type": "integer",
                  "description": "Size of the update file (if applicable)"
                }
              },
              "required": ["id", "database_name", "version", "signatures_count", "last_updated", "update_status", "update_details"]
            },
            "description": "History of ClamAV signature database updates"
          }
        },
        "required": ["success", "timestamp", "current"]
      },
      "SignatureUpdateResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "enum": [true],
            "description": "Indicates successful operation"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp of the update request"
          },
          "updateResult": {
            "type": "object",
            "properties": {
              "updated": {
                "type": "boolean",
                "description": "True if the signatures were updated"
              },
              "databases": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "description": "List of updated signature database files"
              },
              "message": {
                "type": "string",
                "description": "Status message of the update operation"
              }
            },
            "required": ["updated", "databases", "message"]
          },
          "before": {
            "type": "object",
            "properties": {
              "totalSignatures": {
                "type": "integer",
                "description": "Total number of signatures before the update"
              }
            },
            "required": ["totalSignatures"]
          },
          "after": {
            "type": "object",
            "properties": {
              "totalSignatures": {
                "type": "integer",
                "description": "Total number of signatures after the update"
              }
            },
            "required": ["totalSignatures"]
          },
          "message": {
            "type": "string",
            "description": "Detailed message about the update operation"
          }
        },
        "required": ["success", "timestamp", "updateResult", "before", "after"]
      },
      "SignatureHistoryResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "enum": [true],
            "description": "Indicates successful operation"
          },
          "count": {
            "type": "integer",
            "description": "Number of records returned"
          },
          "limit": {
            "type": "integer",
            "description": "Maximum number of records requested"
          },
          "offset": {
            "type": "integer",
            "description": "Number of records skipped"
          },
          "data": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "integer",
                  "description": "Unique identifier for the update record"
                },
                "database_name": {
                  "type": "string",
                  "description": "Name of the updated database"
                },
                "version": {
                  "type": "string",
                  "description": "ClamAV version and signature database version at the time of update"
                },
                "signatures_count": {
                  "type": "integer",
                  "description": "Number of signatures in the database after update"
                },
                "last_updated": {
                  "type": "string",
                  "format": "date-time",
                  "description": "Timestamp of the update"
                },
                "update_status": {
                  "type": "string",
                  "enum": ["SUCCESS", "FAILURE"],
                  "description": "Status of the update operation"
                },
                "update_details": {
                  "type": "string",
                  "description": "Detailed information about the update"
                },
                "file_size": {
                  "type": "integer",
                  "description": "Size of the update file (if applicable)"
                }
              },
              "required": ["id", "database_name", "version", "signatures_count", "last_updated", "update_status", "update_details"]
            },
            "description": "Array of signature update records"
          }
        },
        "required": ["success", "count", "limit", "offset", "data"]
      }
    }
  },
  "security": [],
  "externalDocs": {
    "description": "Find out more about ThreatCheck API",
    "url": "https://github.com/threatcheck/api"
  }
}
